doctype html
html(lang='en')
  head
    <title>!{story.title}</title>
    meta(charset='utf-8')
    meta(name='viewport', content='width=device-width, initial-scale=1')
    <meta name="google-signin-client_id" content="829220596871-tkcc5nujoge6trq2ls28rsc0bge9cp5q.apps.googleusercontent.com">
    <meta http-equiv="Content-Security-Policy" content="media-src https://audio.oxforddictionaries.com https://ssl.gstatic.com https://storage.googleapis.com">
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.tooltipster/4.0.5/css/tooltipster.bundle.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/jquery.tooltipster/4.0.5/css/plugins/tooltipster/sideTip/themes/tooltipster-sideTip-shadow.min.css">
    <!-- Optional JavaScript -->
    <!-- jQuery first, then Popper.js, then Bootstrap JS -->
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
    <script src="https://kit.fontawesome.com/e5e4a7b53c.js" crossorigin="anonymous"></script>
    script(src='/js/practice.js')
    script(src='/js/stjs.js')
    script(src='/js/tooltipster.bundle.min.js')
    link(rel='stylesheet', href='/stylesheets/fonts.css')
    link(rel='stylesheet', href='/stylesheets/style.css')
    link(rel='stylesheet', href='/stylesheets/practice.css')
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/monokai-sublime.min.css" />
    <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
  body(style=(undefined===cfnt ? (undefined===cfwt ? (undefined===cfnt2 ? '' : 'font-family:\''+cfnt2+'\';') : (undefined===cfnt2 ? 'font-weight:'+cfwt : 'font-family:\''+cfnt2+'\'; font-weight:'+cfwt)) : (undefined===cfwt ? (undefined===cfnt2 ? 'font-weight:'+cfwt+'; font-family:\''+cfnt+'\';' : 'font-family:\''+cfnt+'\', \''+cfnt2+'\'; font-weight:'+cfwt) : (undefined===cfnt2 ? 'font-family:\''+cfnt+'\';font-weight:'+cfwt : 'font-family:\''+cfnt+'\', \''+cfnt2+'\'; font-weight:'+cfwt))))
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark" id="navbar" style="background-color:#e74c3c!important;">
      <a class="navbar-brand" href="#none" onclick="home();return false;">#{translation.HOME}</a>
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNavDropdown" aria-controls="navbarNavDropdown" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNavDropdown">
        <ul class="navbar-nav">
          if story.book
            li.nav-item.dropdown
              a#story.nav-link.dropdown-toggle(href='#' data-toggle='dropdown' aria-haspopup='true' aria-expanded='false') #{translation.STORYINDEX}
              div#index.dropdown-menu(aria-labelledby='story')
          if pc
            li.nav-item
              a.nav-link(href='#none' onclick='ReadingOnly();return false;') #{translation.Reading}
            li.nav-item
              a.nav-link(href='#none' onclick='storyTooltip();return false;') #{translation.LearnReading}
            li.nav-item
              a.nav-link(href='#none' onclick='ReadingPractice();return false;') #{translation.Practice}
            li.nav-item
              a.nav-link(href='#none' onclick='showWordLayer();return false;') #{translation.Words}
            li.nav-item
              a.nav-link(href='#none' onclick='chatAIPractice();return false;') #{translation.ChatAI}
            li.nav-item
              a.nav-link(href='#none' onclick='CreateStory();return false;') #{translation.Create}
            li.nav-item
              <a class="nav-link" href="#none" onclick="UpdateStory('#{story.user}', '#{userId}');return false;">#{translation.Update}</a>
            li.nav-item
              <a class="nav-link" href="#none" onclick="DeleteStory('#{story.user}', '#{userId}');return false;">#{translation.Delete}</a>
            li.nav-item
              <a class="nav-link" href="#none" onclick="BookMark();return false;">#{translation.BookMark}</a>
          else
            li.nav-item
              a.nav-link(href='#none' onclick='showReadingOnlyLayer();return false;') #{translation.Reading}
            li.nav-item
              a.nav-link(href='#none' onclick='storyTooltip();return false;') #{translation.LearnReading}
            li.nav-item
              a.nav-link(href='#none' onclick='showWordOnlyLayer();return false;') #{translation.Words}
            li.nav-item
              a.nav-link(href='#none' onclick='showMemoOnlyLayer();return false;') #{translation.Memo}
          li.nav-item
            a.nav-link(href='#none' onclick='books();return false;') #{translation.BOOK}
          li.nav-item
            a.nav-link(href='#none' onclick='stories();return false;') #{translation.STORY}
          li.nav-item
            a.nav-link(href='#none' onclick='story_open_list();return false;') #{translation.BOARD}
          if user
            li.nav-item
              a.nav-link(href='#none' onclick='logout();return false;') #{translation.LOGOUT}
            <form class="form-inline my-2 my-lg-0" method="post" action="/catalog/story_word_datatable">
              <input id="searchWord" name="searchWord" class="form-control mr-sm-2 form-control-sm" type="search" placeholder="Search" aria-label="Search">
              <button class="btn btn-outline-success my-2 my-sm-0 btn-sm" type="submit">#{translation.Search}</button>
            </form>
          else
            li.nav-item
              a.nav-link(href='#none' onclick='login();return false;') #{translation.LOGIN}
            li.nav-item 
              a.nav-link(href='#none' onclick='registration();return false;') #{translation.SIGNUP}
        </ul>
      </div>
    </nav>
      
    div(class='container-fluid' style='padding: 0 0 0 0;')
      div#jb_content.col-lg-12
        div.ql-editor(style='padding: 50px 0 0 0; overflow-y: hidden;')
          if book_title
            if story.title_font
              p(class=story.title_font, style='font-weight:bold;font-size: 2em') #{book_title}<br/><br/>
            else
              p(style='font-weight:bold;font-size: 2em') #{book_title}<br/><br/>
          if story.chapter 
            if story.title_font
              p(class=story.title_font, style='font-weight:bold;font-size: 2em') #{story.chapter}<br/><br/>
            else
              p(style='font-weight:bold;font-size: 2em') #{story.chapter}<br/><br/>
          if story.title_font
            if story.title_size
              if story.title_weight
                <p style='font-weight: #{story.title_weight};font-size: #{story.title_size}' class='#{story.title_font}'>#{story.title}</p><br/><br/>
              else
                <p style='font-weight:bold;font-size: #{story.title_size}' class='#{story.title_font}'>#{story.title}</p><br/><br/>
            else
              if story.title_weight
                <p style='font-weight: #{story.title_weight};font-size:  2.5em' class='#{story.title_font}'>#{story.title}</p><br/><br/>
              else
                <p style='font-weight:bold;font-size:  2.5em' class='#{story.title_font}'>#{story.title}</p><br/><br/>
          else
            if story.title_size
              if story.title_weight
                <p style='font-weight: #{story.title_weight};font-size: #{story.title_size}'>#{story.title}</p><br/><br/>
              else
                <p style='font-weight:bold;font-size: #{story.title_size}'>#{story.title}</p><br/><br/>
            else
              if story.title_weight
                <p style='font-weight: #{story.title_weight};font-size: 2.5em'>#{story.title}</p><br/><br/>
              else
                <p style='font-weight:bold;font-size: 2.5em'>#{story.title}</p><br/><br/>
          if story.author 
            if story.title_font
              p(class=story.title_font) #{story.author}<br/><br/>
            else
              p #{story.author}<br/><br/>
          if story.reference 
            if story.title_font
              p(class=story.title_font)
                a(href=story.reference target='_blank') #{story.reference}
            else
              p 
                a(href=story.reference target='_blank') #{story.reference}
            <br/>
          if story.genre
            span(style='margin-left: 20px;')
            for gnr in story.genre
              a(href=gnr.url) #{gnr.name}
              span(style='margin-left: 20px;')
            <br><br>
          if anchor 
            if story.title_font
              <a href="none" class="#{story.title_font}" onclick="goBokM('#{anchor}');return false;">#{translation.BookMark}</a><br/><br/>
            else
              <a href="none" onclick="goBokM('#{anchor}');return false;">#{translation.BookMark}</a><br/><br/>
          div#st_content !{story.content}
        if story.open == 'Y'
          <div style="text-align: center; margin: 30px;"><button id="favs" type="submit" class="btn btn-primary btn-sm">#{translation.favs}</button></div>
          <input type="hidden" id="facnt" name="facnt" value="#{story.favs}" />
          <input type="hidden" id="favy" name="favy" value="#{translation.favy}" />
          <input type="hidden" id="favn" name="favn" value="#{translation.favn}" />
          <input type="hidden" id="cmm" name="cmm" value="#{translation.cmm}" />
          <input type="hidden" id="smm" name="smm" value="#{translation.smm}" />
          <input type="hidden" id="cmm2" name="cmm2" value="#{translation.cmm2}" />
          <input type="hidden" id="cmm3" name="cmm3" value="#{translation.cmm3}" />
          <form id="cmf" method="post" action="/catalog/story/#{story._id}/comments/replies">
            <div class="form-group">
              <textarea name="content" class="form-control form-control-sm" id="reply-content" placeholder="Reply"></textarea>
            </div>
            <div class='text-right'>
              <button onclick="smf();return false;" class="btn btn-primary btn-sm">#{translation.Save}</button>
            </div>
            <input type="hidden" id="sfkb" name="sfkb" value="#{story._id}" />
          </form>
          if comments
            for comment in comments
              - var cyn = ''
              if comment.comments != ''
                - cyn = 'Y'
              <span style="color: purple;">#{comment.user.name}</span>
              <div id="c_#{comment._id}">#{comment.content}</div>
              <div style="display: inline; float: right;">
                <span id="s_#{comment._id}" onclick="viewR(this);" class="replyB">#{translation.Reply}</span>
                <span id="u_#{comment._id}" onclick="viewU(this, '#{userId}');" class="replyB">#{translation.Update}</span>
                <span id="t_#{comment._id}" onclick="viewT(this, '#{userId}');" class="replyB">#{translation.Delete}</span>
              </div>
              <div id="d_#{comment._id}" style="display: none;">
                <form id="cmf_#{comment._id}" method="post" action="/catalog/story/#{story._id}/comments/#{comment._id}/replies">
                  <div class="form-group">
                    <textarea name="content" class="form-control form-control-sm" id="r_#{comment._id}" placeholder="Reply"></textarea>
                  </div>
                  <div class='text-right'>
                    <button id="b_#{comment._id}" onclick="smf2('#{comment._id}');return false;" class="btn btn-primary btn-sm">#{translation.Save}</button>
                  </div>
                  <input type="hidden" id="sfkb" name="sfkb" value="#{story._id}" />
                  <input type="hidden" id="cyn_#{comment._id}" name="cyn" value="#{cyn}" />
                  <input type="hidden" id="cgb_#{comment._id}" name="cgb" value="R" />
                  <input type="hidden" id="uid_#{comment._id}" name="uid" value="#{comment.user._id}" />
                </form>
              </div>
              if comment.comments != ''
                each cmt in comment.comments
                  include pets-partial
                  +petslist(cmt)
      div#jb_memo.col-lg-6
        div.ql-editor
          div !{memo}
        <div style="display: inline-block; width: 600px; float: left; height: 30px; margin-top: 10px;">
          <input type="file" name="file2" id="file2" class="inputfile">
          <label for="file2" style="line-height: 30px; float: left; text-indent: 0; width: 220px;margin-left: 30px; margin-top: 6px; margin_right: 30px;" class="btn btn-primary btn-sm" title="#{translation.AudioDesc}">#{translation.Audio}</label>
          <audio controls id="myAudio2" style="line-height: 30px; float: right;" autoplay></audio>
        </div>
      div#jb_txtEditor.col-lg-6
        div.standalone-container
          <div id="toolbar-container" class="ql-toolbar ql-snow">
            <span class="ql-formats">
              <select class="ql-font" style="width: 150px;">
                <option selected="">Sans Serif</option>
                <option value="WorkSans">Work Sans</option>
                <option value="LibreFranklin">Libre Franklin</option>
                <option value="Inconsolata">Inconsolata</option>
                <option value="roboto">Roboto</option>
                <option value="mirza">Mirza</option>
                <option value="arial">Arial</option>
                <option value="Oswald">Oswald</option>
                <option value="Caveat">Caveat</option>
                <option value="Raleway">Raleway</option>
                <option value="ShadowsIntoLight">Shadows Into Light</option>
                <option value="AbrilFatface">Abril Fatface</option>
                <option value="Teko">Teko</option>
                <option value="Cormorant">Cormorant</option>
                <option value="AlfaSlabOne">Alfa Slab One</option>
                <option value="PTSans">PT Sans</option>
                <option value="NanumPenScript">나눔 손글씨 펜</option>
                <option value="NanumBrushScript">나눔 손글씨 붓</option>
                <option value="SongMyung">송명</option>
                <option value="Gaegu">개구쟁이</option>
                <option value="Jua">주아</option>
                <option value="GamjaFlower">감자꽃 마을</option>
                <option value="CuteFont">귀여운 폰트</option>
                <option value="Stylish">스타일리시</option>
                <option value="YeonSung">연성</option>
                <option value="HiMelody">하이멜로디</option>
                <option value="Sunflower">해바라기</option>
                <option value="BlackHanSans">검은고딕</option>
                <option value="GothicA1">고딕 A1</option>
                <option value="NanumGothic">나눔고딕</option>
                <option value="NanumMyeongjo">나눔명조</option>
                <option value="PoorStory">서툰이야기</option>
                <option value="BlackAndWhitePicture">흑백사진</option>
              </select>
            </span>
            <span class="ql-formats">
              <select class="ql-header"></select>
              <select class="ql-size">
                <option value="1em">1em</option>
                <option value="1.5em">1.5em</option>
                <option value="2em">2em</option>
                <option value="2.5em">2.5em</option>
                <option value="3em">3em</option>
                <option value="3.5em">3.5em</option>
                <option value="4em">4em</option>
                <option value="6em">6em</option>
                <option value="8em">8em</option>
                <option value="10em">10em</option>
              </select>
            </span>
            <span class="ql-formats">
                <select class="ql-weight" style="width: 100px;">
                    <option value="">fontWeight</option>
                    <option value="100">100</option>
                    <option value="200">200</option>
                    <option value="300">300</option>
                    <option value="normal">normal</option>
                    <option value="500">500</option>
                    <option value="600">600</option>
                    <option value="bold">bold</option>
                    <option value="800">800</option>
                    <option value="900">900</option>
                </select>
            </span>
            <span class="ql-formats">
              <button class="ql-bold"></button>
              <button class="ql-italic"></button>
              <button class="ql-underline"></button>
              <button class="ql-strike"></button>
            </span>
            <span class="ql-formats">
              <select class="ql-color">
                <option selected></option>
                <option value="red"></option>
                <option value="orange"></option>
                <option value="yellow"></option>
                <option value="green"></option>
                <option value="blue"></option>
                <option value="purple"></option>
              </select>
              <select class="ql-background">
                <option selected></option>
                <option value="red"></option>
                <option value="orange"></option>
                <option value="yellow"></option>
                <option value="green"></option>
                <option value="blue"></option>
                <option value="purple"></option>
              </select>
            </span>
            <span class="ql-formats">
              <button class="ql-script" value="sub"></button>
              <button class="ql-script" value="super"></button>
            </span>
            <span class="ql-formats">
              <button class="ql-blockquote"></button>
              <button class="ql-code-block"></button>
            </span>
            <span class="ql-formats">
              <button class="ql-list" value="ordered"></button>
              <button class="ql-list" value="bullet"></button>
              <select class="ql-align"></select>
            </span>
            <span class="ql-formats">
              <button class="ql-link"></button>
              <button class="ql-image"></button>
              <button class="ql-video"></button>
              <button class="ql-audio"></button>
              <button class="ql-formula"></button>
            </span>
            <span class="ql-formats">
              <button class="ql-indent" value="-1"></button>
              <button class="ql-indent" value="+1"></button>
              <button class="ql-direction" value="rtl"></button>
              <button class="ql-clean"></button>
            </span>
          </div>          
          div#snow-container
          <!--<br><span>파일명: </span><input type="text" id="fileName">-->
          <br/>
          <button type="button" style="float: left;margin-left: 10px;" class="btn btn-primary btn-sm" value="save" id="save" onclick="saveMemo('N');return false;">#{translation.Save}</button>
          <span style="float: left; margin-left: 20px;margin-top: 5px;">#{translation.afteradd}</span>
          <div style="display: block; height: 30px; margin-top: 10px;">
            if files
              table(class='table table-striped table-bordered table-hover table-condensed' style='margin-top: 50px;')
                tbody.ftd
                  for file in files
                    tr
                      td
                        <button class="btn btn-primary btn-sm" onclick="cs_change_music('#{file.file_path}');return false;">#{file.file_name}</button>
            <button class="btn btn-primary btn-sm" style="line-height: 30px; float: left;text-indent: 0;width: fit-content;margin-top:5px;margin-left: 10px; margin-right:10px;" onclick="javascript:navigator.clipboard.readText().then(clipboardText => {  document.getElementById('myAudio').setAttribute('src', clipboardText); });">#{translation.pasteAudioSrc}</button>
            <audio controls id="myAudio" style="line-height: 30px; float: left;"></audio>
          </div>
          <!--<span>예시) 파일명이 englishow 이면 englishow.html로 저장됨.</span>-->
      div#word_container.col-lg-6
        table#wdtb.table.table-borderless.table-hover.table-sm.wtd(style='border: none; margin-top: 30px; margin-bottom: 30px;')
          <thead class="thead-light">
            <tr>
              <th scope="col">#{translation.Word}</th>
              <th scope="col">#{translation.Meaning}</th>
              <th scope="col"></th>
            </tr>
          </thead>
          <tbody>
            each word, i in word_list
              tr(style='min-height: 30px; vertical-align: top;') 
                td(style='width: 200px; text-align: left;') #{word.orgTitle}
                <td><input type="text" id="wrd_#{word._id}" class="form-control form-control-sm" value="#{word.content}" /></td>
                td(style='width: 180px; text-align: left;')
                  span(style='display: none;')
                    <i class="fas fa-save" style="margin-left: 10px; cursor: pointer;" onclick="wrdSave('#{word._id}')"></i>
                    <i class="fas fa-book-open" style="margin-left: 10px; cursor: pointer;" onclick="wordPopup('#{word._id}')"></i>
                    <i class="fas fa-graduation-cap" style="margin-left: 10px; cursor: pointer;" onclick="oxfordPopup('#{word.title}')"></i>
                    <i class="fas fa-photo-video" style="margin-left: 10px; cursor: pointer;" onclick="imgAddress(#{i})"></i>
                    <i class="fas fa-trash-alt" style="margin-left: 10px; cursor: pointer;" onclick="wordDelete(this, '#{word._id}')"></i>
                  input(type='hidden' class='wList' value=word._id)
                  input(type='hidden' class='ipt' value=word.title)
                  input(type='hidden' class='iph' value=word.image_address)
          </tbody>
        if files
          table(class='table table-striped table-bordered table-hover table-condensed' style='margin-top: 20px;')
            tbody.fts
              for file in files
                tr
                  td
                    <span id="#{file._id}">#{file.file_name}</span>
                    <button class="btn btn-primary btn-sm" onclick="CopyFilePath('#{file.file_path}');return false;">#{translation.Copy}</button>
                    <button class="btn btn-primary btn-sm" onclick="DeleteFile('#{file._id}','#{file.file_path}');return false;">#{translation.Delete}</button>
        <div style="display: inline-block; float: left; height: 25px; margin-top: 10px; margin-bottom: 30px;">
          form#fileUpload(method="POST", enctype="multipart/form-data")
            <label for="file_upload" style="line-height: 25px; float: left;text-indent: 0;width: auto;" class="btn btn-primary btn-sm" title="#{translation.FileDesc}">#{translation.FileSelect}</label>
            <input type="file" name="file_upload" id="file_upload" class="inputfile">
            input(type='hidden' name='storyId' value=story._id)
            button.btn.btn-primary.btn-sm(type='submit' style="line-height: 25px; float: left; margin-left: 20px;") #{translation.FileUpload}
        </div>
      div#chat-container.col-lg-6
        div#chat-messages(style="width:90%; margin-right:20px;") !{chatGPT}
        div#user-input(style="display: flex")
          <textarea name="message-input" id="message-input" onInput="this.parentNode.dataset.replicatedValue = this.value" placeholder="Type your message..."  class="form-control" style="width:90% ; margin-right:10px;" rows="4"></textarea>
          button(type="button", id="send-button") Send
      script(src="/js/chat-api-library.js")
      div#word_only_container.col-lg-12
        p(style='font-weight:bold;font-size: 2.5em;margin-top:30px;') #{story.title}<br/><br/>
        ul.wsd
          each word in word_list
            li(style='font-weight:bold') #{word.title}<br/>#{word.content}
      div#jb_only_txtEditor.col-lg-12
        p(style='font-weight:bold;font-size: 2.5em;margin-top:30px;') #{story.title}<br/><br/>
        div !{memo}
      div#jb_sidebar.col-lg-6
        <span style="float:left;margin-top:7px;">#{translation.dictionary}</span>
        <input type="text" id="searchStoryWord" name="searchStorytWord" class="form-control form-control-sm" style="width:150px;float:left;margin-left:20px;" />
        <input type="button" style="float:left;margin-left:20px;" class="btn btn-primary btn-sm" id="searchWordButton" value="#{translation.Search}"/>
        <input type="checkbox" style="float:left;margin-left:13px;margin-top:10px;" id="myCheck"> 
        <span style="float:left;margin-left:20px;margin-top:7px;">#{translation.ImageSearch}</span>  
        <input type="button" style="float:left;margin-left:20px;" class="btn btn-primary btn-sm" id="translateButton" value="#{translation.Translation}"/>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
        <div id="treeview1" class=""></div>
    <input type="hidden" id="story_id" name="story_id" value="#{story._id}" />
    <input type="hidden" id="book_id" name="book_id" value="#{book_id}" />
    <input type="hidden" id="book" name="book" value="#{book_id}" />
    <input type="hidden" id="story_title" name="story_title" value="#{story.title}" />
    <input type="hidden" id="book_title" name="book_title" value="#{book_title}" />
    <input type="hidden" id="memo" name="memo" value="#{memo}" />
    <input type="hidden" id="memo_id" name="memo_id" value="#{memo_id}" />
    <input type="hidden" id="chatGPT" name="chatGPT" value="#{chatGPT}" />
    <input type="hidden" id="chatGPT_id" name="chatGPT_id" value="#{chatGPT_id}" />
    <input type="hidden" id="bookMark_id" name="bookMark_id" value="#{bookMark_id}" />
    <input type="hidden" id="hostname" name="hostname" value="#{hostname}" />
    <input type="hidden" id="stusr" name="stusr" value="#{story.user}" />
    <input type="hidden" id="SAVED" name="SAVED" value="#{translation.SAVED}" />
    <input type="hidden" id="DELETED" name="DELETED" value="#{translation.DELETED}" />
    <input type="hidden" id="Delete" name="Delete" value="#{translation.Delete}" />
    <input type="hidden" id="pc" name="pc" value="#{pc}" />
    <input type="hidden" id="dmm" name="dmm" value="#{translation.dmm}" />
    <input type="hidden" id="NotImportance" name="NotImportance" value="#{translation.NotImportance}" />
    <input type="hidden" id="Important" name="Important" value="#{translation.Important}" />
    <input type="hidden" id="VeryImportance" name="VeryImportance" value="#{translation.VeryImportance}" />
    <input type="hidden" id="Indispensable" name="Indispensable" value="#{translation.Indispensable}" />
    <input type="hidden" id="NotKnow" name="NotKnow" value="#{translation.NotKnow}" />
    <input type="hidden" id="SawSeveralTime" name="SawSeveralTime" value="#{translation.SawSeveralTime}" />
    <input type="hidden" id="BeUsedTo" name="BeUsedTo" value="#{translation.BeUsedTo}" />
    <input type="hidden" id="RememberComplete" name="RememberComplete" value="#{translation.RememberComplete}" />
    <input type="hidden" id="ImageAddress" name="ImageAddress" value="#{translation.ImageAddress}" />
    <input type="hidden" id="tooltip" name="tooltip" value="#{tooltip}" />
    <input type="hidden" id="close" name="close" value="#{translation.Close}" />
    <input type="hidden" id="cptr" name="cptr" value="#{translation.Copy}" />
    <input type="hidden" id="CheckWords" name="CheckWords" value="#{translation.CheckWords}" />
    <input type="hidden" id="Uploaded" name="Uploaded" value="#{translation.Uploaded}" />
    <input type="hidden" id="UploadFailed" name="UploadFailed" value="#{translation.UploadFailed}" />
    <input type="hidden" id="cfnt" name="cfnt" value="#{cfnt}" />
    <input type="hidden" id="cfnt2" name="cfnt2" value="#{cfnt2}" />
    <input type="hidden" id="chat_gpt_api_key" name="chat_gpt_api_key" value="#{chat_gpt_api_key}" />
    <form id="ftlp" method="post" action="/catalog/story/#{story._id}">
      <input type="hidden" name="tlp" value="y" />
    </form>
    
    <div id="img_layer" style="display:none;position:fixed;left:50%;top:120px;width:500px;height:80%;overflow:auto;background:#fff;z-index: 110;">
      <button type="button" class="btn btn-primary btn-sm" style="position:relative;left:230px;width:50px; " onclick="javascript:$('#img_layer').css('display','none');">#{translation.Close}</button>
      <div id="show_img"></div>
      <button type="button" class="btn btn-primary btn-sm" style="position:relative;left:230px;width:50px; " id="nextImageButton">#{translation.Next}</button>
      <button type="button" class="btn btn-primary btn-sm" style="position:relative;left:230px;width:50px; " onclick="javascript:$('#img_layer').css('display','none');">#{translation.Close}</button>
    </div>

    <a href="#" id="back-to-top" title="Back to top">&uarr;</a>
    
    <a href="#" id="OpenModal" data-toggle="modal" data-target="#exampleModal"></a>

    <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="exampleModalLabel">#{translation.Tooltip}</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <form>
              <div class="form-group">
                <label for="recipient-name" class="col-form-label">#{translation.ImageAddress}:</label>
                <input type="text" class="form-control form-control-sm" id="recipient-name">
              </div>
              <div class="form-group">
                <label for="message-text" class="col-form-label">#{translation.Definition}:</label>
                <textarea class="form-control form-control-sm" id="message-text"></textarea>
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary btn-sm" data-dismiss="modal" id="tcls">#{translation.Close}</button>
            <button type="button" class="btn btn-primary btn-sm" id="InsertTooltip">#{translation.InsertTooltip}</button>
          </div>
        </div>
      </div>
    </div>

    <a href="#" id="ImageModal" data-toggle="modal" data-target="#imgAddrModal"></a>

    <div class="modal fade" id="imgAddrModal" tabindex="-1" role="dialog" aria-labelledby="imgModalLabel" aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="imgModalLabel">#{translation.Tooltip}</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <form>
              <div class="form-group">
                <label for="w_name" class="col-form-label">#{translation.Word}:</label>
                <input type="text" class="form-control form-control-sm" id="w_name" readOnly>
              </div>
              <div class="form-group">
                <label for="iddr_name" class="col-form-label">#{translation.ImageAddress}:</label>
                <input type="text" class="form-control form-control-sm" id="iddr_name">
              </div>
            <input type="hidden" id="w_id" name="w_id" value=""/>
            <input type="hidden" id="widx" name="widx" value=""/>
            </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary btn-sm" data-dismiss="modal" id="tcs">#{translation.Close}</button>
            <button type="button" class="btn btn-primary btn-sm" id="InsertImgAddr">#{translation.InsertTooltip}</button>
          </div>
        </div>
      </div>
    </div>    

    <a href="#" id="TranslationModal" data-toggle="modal" data-target="#translateModal"></a>

    <div class="modal fade" id="translateModal" tabindex="-1" role="dialog" aria-labelledby="translateModalLabel" aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="translateModalLabel">#{translation.Translation}</h5>
            <button type="button" class="close tts" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            p#translatedText
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary btn-sm tts">#{translation.Close}</button>
          </div>
        </div>
      </div>
    </div>

    <a href="#" id="OpenVideo" data-toggle="modal" data-target="#videoModal"></a>

    <div class="modal fade" id="videoModal" tabindex="-1" role="dialog" aria-labelledby="videoModalLabel" aria-hidden="true">
      <div class="modal-dialog" role="document">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="videoModalLabel">Youtube</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <form>
              <div class="form-group">
                <label for="video_src" class="col-form-label">URL:</label>
                <input type="text" class="form-control form-control-sm" id="video_src">
              </div>
              <div class="form-group">
                <label for="video_width" class="col-form-label">Width:</label>
                <input type="text" class="form-control form-control-sm" id="video_width">
              </div>
              <div class="form-group">
                <label for="video_height" class="col-form-label">Height:</label>
                <input type="text" class="form-control form-control-sm" id="video_height">
              </div>
            </form>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary btn-sm" data-dismiss="modal" id="vcls">#{translation.Close}</button>
            <button type="button" class="btn btn-primary btn-sm" id="InsertVideo">Insert Youtube</button>
          </div>
        </div>
      </div>
    </div>

    <div id="loading">
      <img id="loading-image" src="/images/ajax-loader.gif" alt="Loading..." />
    </div>

    <div class="tooltip_templates">!{ttp}</div>

    <div class="overlay"></div>
    <div class="spanner">
      <div class="loader"></div>
      <p>#{translation.UploadingFile}</p>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.7.1/katex.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
    <script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>
    <script src="/js/quill_setting.js"></script>
    script(src='/js/bootstrap_treeview.js')
    <script src="https://apis.google.com/js/platform.js?onload=ginit" async defer></script>
